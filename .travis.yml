language: python

env:
  global:
    - PYTHON_VERSION=3.6
    - TEST_CMD='python -m pytest -vv -s tests'
    - MAIN_CMD='pipenv run'
    - SETUP_XVFB=true
    - PIPENV_IGNORE_VIRTUALENVS=1

matrix:
  include:
    - os: linux
      sudo: false
    - os: osx
      language: generic

install:
  # CI helpers
  - git clone --depth 1 git://github.com/astropy/ci-helpers.git
  - source ci-helpers/travis/setup_conda.sh

  # Install TimeView
  - source activate test
  - pip install pipenv --upgrade-strategy=only-if-needed
  - pipenv --python=3.6 install --dev .

script:
  - $MAIN_CMD python --version
  - $MAIN_CMD $TEST_CMD
  - $MAIN_CMD black . --check
  - $MAIN_CMD flake8

notifications:
  on_success: change
  on_failure: always

skip_commits:
  files:
    - docs/**/*
    - '**/*.rst'
    - '*.md'
    - .gitignore
    - .travis.yml
    - LICENSE.txt
