language: generic
sudo: false
env:
  global:
  - TEST_CMD='python -m pytest -vv -s tests'
  - MAIN_CMD='pipenv run'
  - SETUP_XVFB=true
  - PIPENV_IGNORE_VIRTUALENVS=1
matrix:
  fast_finish: true
  include:
  - os: linux
    env: PYTHON_VERSION=3.6
  - os: linux
    env: PYTHON_VERSION=3.7
  - os: osx
    language: generic
    env: PYTHON_VERSION=3.6
  - os: osx
    language: generic
    env: PYTHON_VERSION=3.7
before_install:
- git clone --depth 1 git://github.com/astropy/ci-helpers.git
- source ci-helpers/travis/setup_conda.sh
- source activate test
install:
- pip install pipenv --upgrade-strategy=only-if-needed
- pipenv install --dev .
script:
- "$MAIN_CMD python --version"
- "$MAIN_CMD $TEST_CMD"
- "$MAIN_CMD black . --check"
- "$MAIN_CMD flake8"
notifications:
  on_success: change
  on_failure: always
skip_commits:
  files:
  - docs/**/*
  - "**/*.rst"
  - "*.md"
  - ".gitignore"
  - appveyor.yml
  - LICENSE.txt
deploy:
  provider: pypi
  user: j9ac9k
  password:
    secure: oUu2I43XyXRae3r2Sq4mBGcXlFLSju+P0vziTLFcwukAT7+Yn4H+fGZypSgEuU+bWeI1fCq4JTMxvTWAALOQglkdKWT4HlnFGni2OuFPr5PEcWHG9NEJ/JWnqG02BLt8/NSEYy61JDDza4hYfehp029Tio4e/SRhgELc/V9zFGSbem0UsIjYKWpcWZhxo83SDIVNByA9AdRqtLk2KW4MJWpnjpE9wrX4Iw4PBhRAVbDSpC3ObBv462PnC9JdBcoH4pkr7RoE0MamT/VL1Cmt8sQIon1uv450IONAUXqd+tJ3dY1JfHhxsbnJj3tzlZ9gxeaST7UF+zUSfjfbTX0R8t+UEMXKH8ndir7bEQsyQ5HC4prk+ZlwKP3kElYH1qdHnVYyJL6LuqlLm5fOistkwj93u4YTHAvGYAj1SC/B2q6nYycZWdS2rks9yMHS+9IxzdJYrbLXnr8YH+L9AlQKkniyqt/1Vhg9HLliLjRMc4z5vn1jIUJr8VZ3LxswoIz1+2s57z9U4uujdI42UDZU2A6fYNIYrWA/HK3IoeXMjwJay4idlIKdhZ9wsBNtECa2efWC6p2TouFW7pnPSZtUhWHz6E04NfqSOikPmSu9PdaQuswn2GBspOQL1VVZAC1ivHnPgHotd+PYFUCDo2M21g+awdzPsEXzP7I/IZYkh3o=
  distributions: "sdist bdist_wheel"
  on:
    tags: true
    repo: j9ac9k/timeview
