language: generic
sudo: false
env:
  global:
  - TEST_CMD='python -m pytest -vv -s tests'
  - MAIN_CMD='pipenv run'
  - SETUP_XVFB=true
  - PIPENV_IGNORE_VIRTUALENVS=1
matrix:
  fast_finish: true
  include:
  - os: linux
    env: PYTHON_VERSION=3.6
  - os: linux
    env: PYTHON_VERSION=3.7
  - os: osx
    language: generic
    env: PYTHON_VERSION=3.6
  - os: osx
    language: generic
    env: PYTHON_VERSION=3.7
before_install:
- git clone --depth 1 git://github.com/astropy/ci-helpers.git
- source ci-helpers/travis/setup_conda.sh
- source activate test
install:
- pip install pipenv --upgrade-strategy=only-if-needed
- pipenv install --dev .
script:
- "$MAIN_CMD python --version"
- "$MAIN_CMD $TEST_CMD"
- "$MAIN_CMD black . --check"
- "$MAIN_CMD flake8"
notifications:
  on_success: change
  on_failure: always
skip_commits:
  files:
  - docs/**/*
  - "**/*.rst"
  - "*.md"
  - ".gitignore"
  - appveyor.yml
  - LICENSE.txt
deploy:
  provider: pypi
  skip_existing: true
  user: j9ac9k
  password:
    secure: oR9R6PuybyRCGFuXs6HrD9RKjb7CI6Owzv8C0SrJhVE8NSJyEqG1kQ/FxVVmQhOu1VfK4QpBj22BT7Fn3Tb8UN48xIlh3EXVwNS1RU6aUy1mT6KcboAq+McOsWBfAUFPcDArhj3ER3lnW59UlnC27oAYiXz9ClQEnLUBBoBXVuVbaLD8IpEd08ozwuR40u+l7p+X2Fw97QpKpSIYM4WfLLgW/S5ldfCGVfP6r65ixlbzR9TfXbKHEL90InHdKDmk9miOMG1xdBeP+hxgadkPQsWg/v6LKpOQPbJmJy0eHIIwl0Y3cG3lP+FWPam748ipm9SMtzK47J7k6abw3vQ8bqbCihJ2YUgAO4RmETn+1Mbm6OEa5Vbet/9cC90qO6WZKQN7FzvcaS5rnG4B95Upi9RgRLPl9ZsTljSZQfjU/ktw7yRPEW4XTZ1hjOAE+RZONu/00rkEZiLTOQkXGLXPMRGx7aOfvmS5DgaqBJMTjSoaB/f6DTC+WhQ5+CkgC9WBW6AphL/K0NzF5MNCn1YixIrg6YcRnt87LiT9/DSzo2F6Vn3JSevJG32Eu7UM+/IMYzVTfFSqiRhEigvFfM533u0sc5eOzJt7Au8mJcsMKxNlSpmrWsU7GAb6dYHPan0EFNv7x1B8NhJT4BLDXTjW0ThAFQ480HM//SVdbPfGxY0=
  distributions: sdist bdist_wheel
  on:
    tags: true
