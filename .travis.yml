language: generic
sudo: false
env:
  global:
  - TEST_CMD='python -m pytest -vv -s tests'
  - MAIN_CMD='pipenv run'
  - SETUP_XVFB=true
  - PIPENV_IGNORE_VIRTUALENVS=1
matrix:
  fast_finish: true
  include:
  - os: linux
    env: PYTHON_VERSION=3.6
  - os: linux
    env: PYTHON_VERSION=3.7
  - os: osx
    language: generic
    env: PYTHON_VERSION=3.6
  - os: osx
    language: generic
    env: PYTHON_VERSION=3.7
before_install:
- git clone --depth 1 git://github.com/astropy/ci-helpers.git
- source ci-helpers/travis/setup_conda.sh
- source activate test
install:
- pip install pipenv --upgrade-strategy=only-if-needed
- pipenv install --dev .
script:
- "$MAIN_CMD python --version"
- "$MAIN_CMD $TEST_CMD"
- "$MAIN_CMD black . --check"
- "$MAIN_CMD flake8"
notifications:
  on_success: change
  on_failure: always
skip_commits:
  files:
  - docs/**/*
  - "**/*.rst"
  - "*.md"
  - ".gitignore"
  - appveyor.yml
  - LICENSE.txt
deploy:
  provider: pypi
  user: j9ac9k
  password:
    secure: pfrZufJ38Vv5mOv+vy5jleW6FaqGZ5SWJtfbgqcvztzBRK3qK+XLHvm2dDvEbrgIe8ss6ZvdSdf9SIyl1k+QBTSrzMEvvtBtCdgGWRrbjaM7Rsg9F9N2u5JvpoRX6LgM9TA/PfqT6PV2PXi+ax/zsbBpUz+UJdhHY5Yix9LBgPuqv50ntwvhlgtN53fItq+8SS9eYeRzQopwbrhlQacyPlUiENy4u9XFsl+Y2VYz1rlzt9PSXGJsfBpf/KecKf2yjw3wP1oGURkMbmk8oMB2gLyvAn6g9QQDUb5xzD01M3zViH1O7bOJ4iyA2FquN369WYlif2W5hNQtMYE5KAXCm3q5MOJkS4d0QkAmGgQBY+iirhV7CX2KI1mwBj9BO5cNRg2f6hm2ZPYUgd8GOhOrqTpMiqLW+IJm7zT4wAbamIaxozxz1VMLw6v2oImsK1AIL1pYhFR5kbI/ZXls+tpLqg91fgXbXRFasdmHqRCqliLihZrTaM9EFKIvNUUtOjAymH4517KZ8wMNTJ0wIGs3uCV95zWkREejjcyM8M9cKLFAJWJ8nxm0ixy/P62/Md8vRTrDzTSPoBZWrxpoTScj/WejaYDfsVuSugV2W1h0B3e8XKIbmdLOIbJ9R8lFVKCAj385ug8Fu5cu+dF3lzrmZIYJneNmrwIZ2al2TYeXDUU=
  distributions: sdist bdist_wheel
  on:
    tags: true
